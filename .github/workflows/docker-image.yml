      - name: Deploy to server
        run: |
          ssh -i ~/.ssh/id_rsa -o StrictHostKeyChecking=yes "$SSH_USER@$SERVER_IP" 'bash -s' << 'ENDSSH'
            set -e

            mkdir -p $DEPLOY_PATH
            cd $DEPLOY_PATH

            # Save env file
            printf "%s\n" "$ENV_PRODUCTION_FILE" > .env

            # Pull latest images
            docker pull $DOCKER_USERNAME/borsibaar-backend:v1
            docker pull $DOCKER_USERNAME/borsibaar-frontend:v1

            # Stop existing containers
            docker compose -f "$DOCKER_COMPOSE_FILE" down

            # Start containers
            docker compose -f "$DOCKER_COMPOSE_FILE" up -d

            echo "Deployment complete!"
            docker compose -f "$DOCKER_COMPOSE_FILE" ps
          ENDSSH
